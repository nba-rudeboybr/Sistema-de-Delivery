<!-- src/app/components/kitchen-dashboard/kitchen-dashboard.component.html -->

<div class="kitchen-dashboard-container">
  <div class="header">
    <h1>ğŸ‘¨â€ğŸ³ Dashboard da Cozinha</h1>
    <div class="status-filter">
      <label for="statusFilter">Filtrar por Status:</label>
      <select 
        id="statusFilter" 
        [(ngModel)]="selectedStatus" 
        (change)="onStatusChange()"
        class="status-select"
      >
        <option *ngFor="let option of statusOptions" [value]="option.value">
          {{ option.icon }} {{ option.label }}
        </option>
      </select>
    </div>
  </div>

  <div class="orders-section">
    <div class="orders-header">
      <h2>ğŸ½ï¸ Pedidos Ativos</h2>
      <div class="orders-count">
        {{ filteredOrders.length }} pedido(s) encontrado(s)
      </div>
    </div>

    <div class="orders-grid" *ngIf="filteredOrders.length > 0; else noOrders">
      <div class="order-card" *ngFor="let order of filteredOrders" [class]="getStatusClass(order.status)">
        <div class="order-header">
          <div class="order-info">
            <h3>{{ order.customerName }}</h3>
            <p class="customer-phone">ğŸ“ {{ order.customerPhone }}</p>
            <p class="delivery-address">ğŸ“ {{ order.deliveryAddress }}</p>
            <div class="order-status">
              <span class="status-icon">{{ getStatusIcon(order.status) }}</span>
              <span class="status-label">{{ getStatusLabel(order.status) }}</span>
            </div>
          </div>
          <div class="order-total">
            <span class="total-label">Total:</span>
            <span class="total-value">R$ {{ calculateOrderTotal(order).toFixed(2) }}</span>
          </div>
        </div>

        <div class="order-items" *ngIf="order.items && order.items.length > 0">
          <h4>Itens do Pedido:</h4>
          <div class="items-list">
            <div class="item" *ngFor="let item of order.items">
              <span class="item-quantity">{{ item.quantity }}x</span>
              <span class="item-name">{{ getDishName(item.dishId) }}</span>
              <span class="item-price">R$ {{ (getDishPrice(item.dishId) * item.quantity).toFixed(2) }}</span>
            </div>
          </div>
        </div>

        <div class="order-actions" *ngIf="canUpdateStatus(order.status)">
          <!-- BotÃ£o para marcar como PREPARING -->
          <button 
            class="btn btn-warning" 
            (click)="updateOrderStatus(order, 'PREPARING')"
            *ngIf="order.status === 'NEW'"
          >
            ğŸ‘¨â€ğŸ³ Iniciar Preparo
          </button>
          
          <!-- BotÃ£o para marcar todos os itens como prontos -->
          <button 
            class="btn btn-success" 
            (click)="markAllItemsAsReady(order)"
            *ngIf="order.status === 'PREPARING'"
          >
            âœ… Marcar Todos Prontos
          </button>
          
          <!-- BotÃ£o para marcar como READY -->
          <button 
            class="btn btn-primary" 
            (click)="markAsReady(order)"
            *ngIf="order.status === 'PREPARING'"
          >
            ğŸ½ï¸ Marcar Pronto
          </button>
          
          <!-- BotÃ£o para marcar como DELIVERED -->
          <button 
            class="btn btn-info" 
            (click)="markAsDelivered(order)"
            *ngIf="order.status === 'READY'"
          >
            ğŸšš Marcar Entregue
          </button>
          
          <!-- BotÃ£o para cancelar -->
          <button 
            class="btn btn-danger" 
            (click)="updateOrderStatus(order, 'CANCELLED')"
            *ngIf="order.status !== 'CANCELLED'"
          >
            âŒ Cancelar Pedido
          </button>
        </div>

        <div class="order-actions" *ngIf="canDeleteOrder(order)">
          <button 
            class="btn btn-danger btn-sm delete-btn" 
            (click)="deleteOrder(order)"
            title="Remover do histÃ³rico"
          >
            ğŸ—‘ï¸ Remover do HistÃ³rico
          </button>
        </div>

        <div class="order-timestamp" *ngIf="order.createdAt">
          <small>Pedido criado em: {{ order.createdAt | date:'dd/MM/yyyy HH:mm' }}</small>
        </div>
      </div>
    </div>

    <ng-template #noOrders>
      <div class="no-orders">
        <div class="no-orders-icon">ğŸ½ï¸</div>
        <h3>Nenhum pedido encontrado</h3>
        <p>NÃ£o hÃ¡ pedidos com o status selecionado no momento.</p>
        <p>Tente alterar o filtro de status acima.</p>
      </div>
    </ng-template>
  </div>

  <!-- Resumo dos Status -->
  <div class="status-summary">
    <h3>ğŸ“Š Resumo dos Pedidos</h3>
    <div class="summary-cards">
      <div class="summary-card new">
        <div class="summary-icon">ğŸ†•</div>
        <div class="summary-info">
          <div class="summary-count">{{ newOrdersCount }}</div>
          <div class="summary-label">Novos</div>
        </div>
      </div>
      
      <div class="summary-card preparing">
        <div class="summary-icon">ğŸ‘¨â€ğŸ³</div>
        <div class="summary-info">
          <div class="summary-count">{{ preparingOrdersCount }}</div>
          <div class="summary-label">Preparando</div>
        </div>
      </div>
      
      <div class="summary-card ready">
        <div class="summary-icon">âœ…</div>
        <div class="summary-info">
          <div class="summary-count">{{ readyOrdersCount }}</div>
          <div class="summary-label">Prontos</div>
        </div>
      </div>
    </div>
  </div>
</div>